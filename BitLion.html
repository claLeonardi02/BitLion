<!DOCTYPE html>
<html lang="it">
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1" charset="utf-8">
	<title>
		BitLion
	</title>
	<style>
		.link {
			text-decoration: none;
			color: black;
			font-size: 20px;
		}

		.link:hover {
			text-decoration: none;
			color: grey;
			font-size: 20px;
		}

		textarea {
			width: 300px;
			height: 300px;
		}

		button {
			border-color: black;
			width: 100px;
			height: 20px;
			border: none;
			color: black;
			background-color: burlywood;
			text-align: center;
		}
		button:hover {
			background-color: rgb(218, 151, 63);
		}
	</style>
	<script>
		window.onload = function()
		{
			document.getElementById("test").style.display = "none";
			document.getElementById("test1").style.display = "none";
		}

		function copy()
		{
			var copyText = document.getElementById("stampa");

			copyText.select();
			navigator.clipboard.writeText(copyText.value);
		}

		function clean()
		{
			var testo = document.getElementById("testo").value;

			if(testo == "/dev")
			{
				alert("Developer's tools enabled")

				document.getElementById("test").style.display = "block";
				document.getElementById("test1").style.display = "block";
			}

			document.getElementById("testo").value = "";
			document.getElementById("stampa").innerHTML = "";
		}
		
		function dec_bin(num)
		{
			var binary = "";

			while(num!=0)
			{
				r = num % 2;
				num = (num-r)/2;
				binary = r + binary;
			}
			
			return binary;
		}

		function bin_dec(num)
		{
			let decimale = 0;
			const length = num.length;

			for(let i=0; i<length; i++)
			{
				const cifra = parseInt(num[i]);
				const esponente = length -1 -i;
				decimale += cifra * Math.pow(2, esponente);	
			}
			return decimale;
		}


		function toBin()
		{
			var testo = document.getElementById("testo").value;
			var split = testo.split('');
			var result = "";

			for(let i=0; i<split.length; i++)
			{
				
				if(split[i] == ' ')
				{
					result += "0100000";
				}
				else if(split[i].charCodeAt(0) == 10) 
				{
					result += "0001010";
				}
				else if (split[i].charCodeAt(0)>=33 && split[i].charCodeAt(0)<=126)
				{
					var decimale = dec_bin(split[i].charCodeAt(0));
					if(decimale.length<7)
					{
						decimale = "0" + decimale;
					}
					result += decimale;
				}
			}

			if(document.getElementById("test").style.display == "none")
			{
				var res1 = zeroTrust(result);
				var res2 = unoTrust(res1);
				document.getElementById("stampa").innerHTML = res2;
			}
			else
			{
				document.getElementById("stampa").innerHTML = result;
			}

			
			
		}

		function toChar()
		{	
			var testo = document.getElementById("testo").value;
			if(document.getElementById("test").style.display == "none")
			{
				var res1 = onlyTrustZero(testo);
				var res2 = onlyTrustUno(res1);
				var split = res2.split('');
			}
			else
			{
				var split = testo.split('');
			}

			var result = "";
			
			for(let i=0; i<split.length; i=i+7)
			{
				{
					let lettera = "";
					lettera += split[i];
					lettera += split[i+1];
					lettera += split[i+2];
					lettera += split[i+3];
					lettera += split[i+4];
					lettera += split[i+5];
					lettera += split[i+6];

					var num = bin_dec(lettera);
					if(num==32)
					{
						result += " ";
					}
					else
					{
						result += String.fromCharCode(num);
					}
				}	
			}
			document.getElementById("stampa").innerHTML = result;
		}

		function test()
		{
			var testo = document.getElementById("testo").value;
			var split = testo.split('');
			var res2 = onlyTrustZero(testo);
			var res3 = onlyTrustUno(res2);
			document.getElementById("stampa").innerHTML = res3;
		}

		function onlyTrustZero(num)
		{
			var r = "";
			for(var i=0; i< num.length; i++)
			{
				if(i+1<num.length)
				{
					c = num[i+1];
					if(num[i]==0 && c>1)
					{
						for(var j=0; j<c; j++)
						{
							r += "0";
						}
						i++;
					}
					else
					{
						if(num == 0)
						{
							r += "0";
						}
						else
						{
							car = num[i];
							r += car;
						}
					}
				}
				else if(i+1 == num.length)
				{
					car = num[i];
					r += car;
				}
			}
			return r;
		}

		function onlyTrustUno(num)
		{
			var r = "";
			for(var i=0; i< num.length; i++)
			{
				if(i+1<num.length)
				{
					c = num[i+1];
					if(num[i]==1 && c>1)
					{
						for(var j=0; j<c; j++)
						{
							r += "1";
						}
						i++;
					}
					else
					{
						if(num == 1)
						{
							r += "1";
						}
						else
						{
							car = num[i];
							r += car;
						}
					}
				}
				else if(i+1 == num.length)
				{
					car = num[i];
					r += car;
				}
			}
			return r;
		}

		function zeroTrust(codice)
		{
			var r = "";
			for(var i=0; i<codice.length;i++)
			{
				if(codice[i] == 0)
				{
					var z = 1;
					var flag = true;

					while(i+1<codice.length && flag==true)
					{
						if(codice[i+1] == 0)
						{
							z++;
							i++;
						}
						else
						{
							flag = false;
						}
					}
					if(z == 1)
					{
						r += 0;
					}
					else
					{
						r += "0" + z;
					}
					
				}
				else
				{
					r += codice[i];
				}
			}
			return r;
		}


		function unoTrust(codice)
		{
			var r = "";
			for(var i=0; i<codice.length;i++)
			{
				if(codice[i] == 1)
				{
					var z = 1;
					var flag = true;

					while(i+1<codice.length && flag==true)
					{
						if(codice[i+1] == 1)
						{
							z++;
							i++;
						}
						else
						{
							flag = false;
						}
					}
					if(z == 1)
					{
						r += 1;
					}
					else
					{
						r += "1" + z;
					}
					
				}
				else
				{
					r += codice[i];
				}
			}
			return r;
		}

	</script>
</head>
<body>
	<div style="margin-left: 15px">
		<h1>
			Converter v2.5
		</h1>
		<div id="test1">
			<p style="font-style: italic;">Conversion swapped to version 2</p>
		</div>
		<textarea type="text" id="testo" placeholder="es: S3Nd NuD3S"></textarea>
		<br>
		<button onclick="toBin()" type="button"> Convert </button>
		<button onclick="toChar()" type="button"> Translate </button>
		<button onclick="clean()" type="button"> Delete all </button>
		<br>
		<button style="width:308px; margin-top:5px; margin-bottom: 10px; " onclick="copy()" type="button"> Copy to clipboard </button>
		<br>
		<textarea style="background-color: antiquewhite" id="stampa"></textarea>	
		<br>
		<div id="test">
			<button style="width:308px; margin-top:5px; margin-bottom: 10px; " onclick="test()" type="button"> Test </button>
		</div>	
		
	</div>
</html>
